<div class="min-h-screen bg-gray-100 flex items-center justify-center p-4">

  <div class="bg-white rounded-xl shadow-lg overflow-hidden w-full max-w-5xl flex flex-col lg:flex-row">

    <div class="hidden lg:flex flex-1 items-center justify-center p-8 bg-gray-800">
      <div class="aspect-square w-full">
        <iframe class="w-full h-full"
          src="https://lottie.host/embed/6480b745-fcb7-4d79-96b0-d0b08d474617/dYp7od5iw6.lottie" frameborder="0">
        </iframe>
      </div>
    </div>

    <div class="flex-1 p-8 md:p-12">
      <h2 class="text-3xl font-bold text-gray-800 mb-6">Edit Your Profile</h2>

      <div *ngIf="isLoading" class="text-center py-4">
        <div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-gray-800"></div>
        <p class="mt-2 text-gray-600">Loading...</p>
      </div>

      <div *ngIf="updateError" class="mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg">
        {{ updateError }}
      </div>

      <form [formGroup]="personalInfoForm" (ngSubmit)="updateUser()" novalidate class="space-y-4">

        <div>
          <label for="fullName" class="block text-sm font-medium text-gray-700 mb-2">User Name *</label>
          <input id="fullName" type="text"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
            [class.border-red-500]="fullNameControl?.invalid && fullNameControl?.touched" formControlName="fullName"
            placeholder="Enter your username" />
          <div *ngIf="fullNameControl?.invalid && fullNameControl?.touched" class="text-red-600 text-sm mt-1">
            <div *ngIf="fullNameControl?.errors?.['required']">Username is required</div>
            <div *ngIf="fullNameControl?.errors?.['minlength']">Username must be at least 2 characters</div>
          </div>
        </div>

        <div>
          <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
          <input id="email" type="email"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
            [class.border-red-500]="emailControl?.invalid && emailControl?.touched" formControlName="email"
            placeholder="Enter your email" />
          <div *ngIf="emailControl?.invalid && emailControl?.touched" class="text-red-600 text-sm mt-1">
            <div *ngIf="emailControl?.errors?.['required']">Email is required</div>
            <div *ngIf="emailControl?.errors?.['email']">Please enter a valid email</div>
          </div>
        </div>

        <div>
          <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Update Password</label>
          <div class="relative">
            <input id="password" [type]="hidePassword ? 'password' : 'text'"
              class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
              [class.border-red-500]="passwordControl?.invalid && passwordControl?.touched" formControlName="password"
              placeholder="Enter new password (optional)" />
            <button type="button"
              class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 transition-colors"
              (click)="togglePasswordVisibility()" tabindex="-1">
              <svg *ngIf="hidePassword" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M3.98 8.223A10.477 10.477 0 0112 5.25c4.76 0 9.006 1.015 12 3.98-.035.034-.055.054-.09.088a7.028 7.028 0 01-1.002.66c-1.127.669-2.31 1.258-3.483 1.77-1.18.52-2.392.83-3.627.939-.434.038-.87-.008-1.284-.13a7.5 7.5 0 01-2.03-1.096A7.5 7.5 0 019 13.5c-1.397.0-2.73-.298-3.957-.887-1.21-.575-2.296-1.31-3.238-2.196L.18 8.441a.75.75 0 01-.013-.016a10.477 10.477 0 013.814-1.928zM12 11a4.5 4.5 0 100-9 4.5 4.5 0 000 9z" />
              </svg>
              <svg *ngIf="!hidePassword" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M2.036 12.336A12.345 12.345 0 011.256 10c0-1.83 1.11-3.32 2.62-4.148m18.73 4.148c1.51 0 2.62 1.49 2.62 3.32s-1.11 3.32-2.62 4.148M21 12c0-1.28-.68-2.43-1.756-3.148M3.056 12c0 1.28.68 2.43 1.756 3.148M12 16.5a4.5 4.5 0 100-9 4.5 4.5 0 000 9z" />
              </svg>
            </button>
          </div>
          <div *ngIf="passwordControl?.invalid && passwordControl?.touched" class="text-red-600 text-sm mt-1">
            <div *ngIf="passwordControl?.errors?.['minlength']">Password must be at least 6 characters</div>
          </div>
        </div>

        <div>
          <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-2">Confirm Password</label>
          <div class="relative">
            <input id="confirmPassword" [type]="hidePassword ? 'password' : 'text'"
              class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
              [class.border-red-500]="passwordMismatch" formControlName="confirmPassword"
              placeholder="Confirm new password" />
            <button type="button"
              class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 transition-colors"
              (click)="togglePasswordVisibility()" tabindex="-1">
              <svg *ngIf="hidePassword" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M3.98 8.223A10.477 10.477 0 0112 5.25c4.76 0 9.006 1.015 12 3.98-.035.034-.055.054-.09.088a7.028 7.028 0 01-1.002.66c-1.127.669-2.31 1.258-3.483 1.77-1.18.52-2.392.83-3.627.939-.434.038-.87-.008-1.284-.13a7.5 7.5 0 01-2.03-1.096A7.5 7.5 0 019 13.5c-1.397.0-2.73-.298-3.957-.887-1.21-.575-2.296-1.31-3.238-2.196L.18 8.441a.75.75 0 01-.013-.016a10.477 10.477 0 013.814-1.928zM12 11a4.5 4.5 0 100-9 4.5 4.5 0 000 9z" />
              </svg>
              <svg *ngIf="!hidePassword" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M2.036 12.336A12.345 12.345 0 011.256 10c0-1.83 1.11-3.32 2.62-4.148m18.73 4.148c1.51 0 2.62 1.49 2.62 3.32s-1.11 3.32-2.62 4.148M21 12c0-1.28-.68-2.43-1.756-3.148M3.056 12c0 1.28.68 2.43 1.756 3.148M12 16.5a4.5 4.5 0 100-9 4.5 4.5 0 000 9z" />
              </svg>
            </button>
          </div>
          <div *ngIf="passwordMismatch" class="text-red-600 text-sm mt-1">
            Passwords must match!
          </div>
        </div>

        <div>
          <label for="image" class="block text-sm font-medium text-gray-700 mb-2">Update Profile Image</label>
          <input id="image" type="file" accept="image/*"
            class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200 transition-colors cursor-pointer"
            (change)="onFileSelected($event)" />
          <p class="text-xs text-gray-500 mt-1">Accepted formats: JPG, PNG, GIF, WebP (Max 5MB)</p>
        </div>

        <button type="submit"
          class="w-full bg-gray-800 text-white font-bold py-3 px-4 rounded-lg hover:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
          [disabled]="!personalInfoForm.valid || isLoading">
          <span *ngIf="!isLoading">Update Info</span>
          <span *ngIf="isLoading" class="flex items-center justify-center">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div>
            Updating...
          </span>
        </button>
      </form>
    </div>
  </div>
</div>